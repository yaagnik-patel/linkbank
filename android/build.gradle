// Android build configuration for LinkBank
buildscript {
    ext {
        buildToolsVersion = "34.0.0"
        minSdkVersion = 21
        compileSdkVersion = 34
        targetSdkVersion = 34
        ndkVersion = "26.1.10909125"
    }
    dependencies {
        classpath("com.android.tools.build:gradle:8.3.0")
        classpath("com.facebook.react:react-native-gradle-plugin")
        classpath("org.jetbrains.kotlin:kotlin-gradle-plugin:2.0.20")
    }
}

allprojects {
    repositories {
        google()
        mavenCentral()
    }
}

subprojects {
    afterEvaluate { project ->
        if (project.hasProperty("android")) {
            android {
                compileSdkVersion 34
                buildToolsVersion "34.0.0"
                
                defaultConfig {
                    minSdkVersion 21
                    targetSdkVersion 34
                    multiDexEnabled true
                }

                compileOptions {
                    sourceCompatibility JavaVersion.VERSION_17
                    targetCompatibility JavaVersion.VERSION_17
                }

                kotlinOptions {
                    jvmTarget = '17'
                    freeCompilerArgs += [
                        "-Xskip-prerelease-check",
                        "-opt-in=kotlin.RequiresOptIn"
                    ]
                }

                packagingOptions {
                    pickFirst '**/libc++_shared.so'
                    pickFirst '**/libjsc.so'
                    pickFirst '**/libjsc.so'
                }
            }
        }
    }
}

android {
    compileSdkVersion 34
    buildToolsVersion "34.0.0"
    defaultConfig {
        applicationId "com.yaaggnik.linkbank"
        minSdkVersion 21
        targetSdkVersion 34
        versionCode 1
        versionName "1.0.0"
        multiDexEnabled true
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
        debug {
            debuggable true
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_17
        targetCompatibility JavaVersion.VERSION_17
    }

    kotlinOptions {
        jvmTarget = '17'
        freeCompilerArgs += [
            "-Xskip-prerelease-check",
            "-opt-in=kotlin.RequiresOptIn"
        ]
    }

    packagingOptions {
        pickFirst '**/libc++_shared.so'
        pickFirst '**/libjsc.so'
    }

    dexOptions {
        javaMaxHeapSize "4g"
    }
}

dependencies {
    implementation 'androidx.multidex:multidex:2.0.1'
}

apply plugin: 'com.android.application'
apply plugin: 'org.jetbrains.kotlin.android'
